install.packages("biom", repos='http://cran.us.r-project.org')
library("biom")
wood_biom <- read_biom("wood.otu_table.for_maaslin.sort.biom")
wood_table <- as.data.frame(as(biom_data(wood_biom), "matrix"))
wood_rel <- sweep(wood_table, 2, colSums(wood_table), FUN = "/")
rownames(wood_rel) <- paste("OTU", rownames(wood_rel), sep = "")
wood_rel2 <- wood_rel[0, ]
wood_rel2[nrow(wood_rel2) + 1, ] <- c("21", "23", "24", "25", "28", "29", "30", "35", "36", "37", "39", "41", "55", "56", "58", "59", "65", "66", "67", "71", "80", "81", "89", "90", "94", "95", "145", "148", "150", "208", "209", "210", "211", "221", "222", "223", "224", "240", "241", "244", "246")
wood_rel2[nrow(wood_rel2) + 1, ] <- c("c15", "c15", "c15", "c15", "c16", "c16", "c16", "c16", "c1", "c1", "c1", "c1", "c27", "c27", "c27", "c27", "c2", "c2", "c2", "c2", "c23", "c23", "c17", "c17", "c17", "c17", "c4", "c4", "c4", "c10", "c10", "c10", "c10", "c11", "c11", "c11", "c11", "c12", "c12", "c13", "c13")
wood_rel2[nrow(wood_rel2) + 1, ] <- c("5.09", "2.06", "1.41", "0.97", "1.35", "0.41", "1.48", "0.73", "0.96", "1.28", "1.91", "0.71", "2.48", "0.58", "2.41", "2.21", "0.15", "1.04", "0.92", "1.45", "0.37", "0.69", "3.23", "2.88", "1.81", "2.03", "0.83", "1.07", "0.94", "0.01", "0.88", "0.92", "1.47", "4.12", "1.62", "0.76", "12.13", "3.51", "9.45", "1.4", "1.28")
wood_rel2[nrow(wood_rel2) + 1, ] <- c("2.62", "6.89", "1.3", "4.26", "1.32", "1.01", "0.96", "1.18", "0.23", "0.53", "0.41", "0.27", "0.68", "0.67", "0.88", "0.65", "0.82", "2.04", "0.31", "0.65", "0.32", "0.61", "1.85", "2.09", "0.43", "11.29", "1.62", "0.92", "1.04", "1.8", "1.86", "2.8", "0.84", "1.1", "4.55", "4.32", "4.95", "1.12", "1.6", "3.13", "2.61")
wood_rel2[nrow(wood_rel2) + 1, ] <- c("2.03", "1.64", "1.58", "0.99", "0.96", "0.51", "2.28", "0.87", "0.74", "1.56", "1.33", "1.06", "6.6", "0.49", "5.9", "1.28", "0.05", "0.75", "1.58", "1.47", "0.4", "1.07", "1.82", "2.76", "1.41", "2.37", "1.01", "0.87", "1.27", "0.02", "0.02", "1.1", "2.38", "0.34", "1.48", "1.46", "5.18", "0.37", "1.3", "0.41", "1.31")
wood_rel2[nrow(wood_rel2) + 1, ] <- c("0.84", "3.96", "0.76", "7.69", "3.99", "0.54", "4.14", "1.34", "0.08", "1.22", "0.4", "0.54", "0.21", "0.33", "0.3", "0.43", "0.57", "0.09", "1.28", "0.42", "0.25", "0.46", "0.06", "0.63", "5.36", "4.18", "1.93", "3.17", "1.08", "1", "1.24", "1.19", "0.55", "2.26", "5.47", "1.96", "6.5", "0.02", "0.05", "4.43", "1.46")
wood_rel2[nrow(wood_rel2) + 1, ] <- c("60fat", "60fat", "60fat", "60fat", "60fat", "60fat", "60fat", "60fat", "ND", "ND", "ND", "ND", "60fat", "60fat", "60fat", "60fat", "ND", "ND", "ND", "ND", "ND", "ND", "60fat", "60fat", "60fat", "60fat", "ND", "ND", "ND", "45fat", "45fat", "45fat", "45fat", "45fat", "45fat", "45fat", "45fat", "45fat", "45fat", "45fat", "45fat")
wood_rel2[nrow(wood_rel2) + 1, ] <- c("C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "DBA", "DBA", "DBA", "DBA", "C57", "C57", "C57", "C57", "DBA", "DBA", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57", "C57")
row.names(wood_rel2) <- c("samples", "cage", "Pou5f1", "Bcn1", "Dppa3", "Tnfa", "Diet", "Mouseline")
wood_rel_merge <- rbind(wood_rel2, wood_rel)
write.table(wood_rel_merge, sep = "\t", file = "wood.otu_table.upload_maaslin.txt", row.names = TRUE, col.names = FALSE, quote = FALSE)